(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9b660942"],{"561a":function(e,a,t){},7259:function(e,a,t){"use strict";t("561a")},c79a:function(e,a,t){"use strict";t.r(a);var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("excel-upload",{on:{"update-filedata":function(a){return e.fileData=a}}}),e.fileData&&e.fileData.headers?t("v-data-table",{staticClass:"elevation-1",staticStyle:{"margin-top":"20px"},attrs:{headers:e.tableData.headers,items:e.tableData.data},scopedSlots:e._u([{key:"items",fn:function(a){return e._l(e.tableData.headers,(function(r,n){return t("td",{key:n},[e._v("\n        "+e._s(a.item[r.value])+"\n      ")])}))}}],null,!1,3672058996)},[t("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"})],1):e._e()],1)},n=[],i=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"upload"},[t("v-subheader",[t("label",{attrs:{for:"file"}},[e._v("Spreadsheet")])]),t("input",{ref:"uploadInputRef",staticStyle:{display:"none"},attrs:{id:"file",type:"file",accept:e.sheetJSFT},on:{change:e.handleUpload}}),t("div",{staticClass:"upload-dragger",class:{"is-dragover":e.dragover},on:{drop:e.handleDropFile,dragenter:e.handleSuppress,dragover:e.handleSuppress,dragleave:function(a){a.preventDefault(),e.dragover=!1},click:function(a){return e.$refs.uploadInputRef.click()}}},[e._v("\n    Drop a file here or "),t("em",[e._v("Upload")])]),t("div",{staticClass:"upload-tip"},[e._v("上传文件大小不超过 "+e._s(e.filesizeLimitUnitMB)+" MB")])],1)},s=[],l=t("1146"),o=t.n(l),d={name:"ExcelUpload",props:{filesizeLimitUnitMB:{type:Number,default:2}},data:function(){var e=["xlsx","xlsb","xlsm","xls"].map((function(e){return".".concat(e)})).join(",");return{loading:!1,dragover:!1,sheetJSFT:e,headers:[],fileData:{headers:[],data:[]}}},methods:{handleUpload:function(e){this.loading=!0;var a=e.target.files||[];a&&a[0]&&this.beforeUpload(a[0])&&this.readFile(a[0])},handleDropFile:function(e){e.stopPropagation(),e.preventDefault(),this.dragover=!1;var a=e.dataTransfer.files||[];a&&a[0]&&this.readFile(a[0])},handleSuppress:function(e){e.stopPropagation(),e.preventDefault(),this.dragover=!0},readFile:function(e){var a=this,t=new FileReader;t.onload=function(e){var t=e.target.result,r=o.a.read(t,{type:"binary"}),n=r.SheetNames[0],i=r.Sheets[n],s=o.a.utils.sheet_to_json(i);a.handleSuccess(a.makeHeaders(i),s)},t.readAsBinaryString(e)},handleSuccess:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.$emit("update-filedata",{headers:e,data:a})},makeHeaders:function(e){for(var a=o.a.utils.decode_range(e["!ref"]),t=a.s.r,r=[],n=a.s.c;n<=a.e.c;n+=1){var i=e[o.a.utils.encode_cell({c:n,r:t})];r.push(i&&i.t?o.a.utils.format_cell(i):"")}return r},beforeUpload:function(e){var a=e.size/1e3/1e3<=this.filesizeLimitUnitMB;return a||this.$message.warning("File size can not exceed ".concat(this.filesizeLimitUnitMB,"MB!")),a}}},u=d,c=(t("7259"),t("2877")),f=Object(c["a"])(u,i,s,!1,null,"3d5cfece",null),p=f.exports,h={name:"ExcelUploadComponent",components:{ExcelUpload:p},data:function(){return{fileData:{}}},computed:{tableData:function(){if(!this.fileData)return{headers:[],data:[]};for(var e=[],a=this.fileData.headers||[],t=this.fileData.data||[],r=0,n=a.length;r<n;r+=1)e.push({text:a[r],value:a[r]});return{headers:e,data:t}}}},v=h,g=Object(c["a"])(v,r,n,!1,null,null,null);a["default"]=g.exports}}]);